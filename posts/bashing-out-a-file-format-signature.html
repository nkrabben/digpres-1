<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Bashing out a file format signature - NYPL Digital Preservation</title> <link rel="shortcut icon" href="/digpres/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/digpres/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=2596733842"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '2596733842', { 'anonymize_ip': true }); </script> <script src="/digpres/assets/js/vendor/lunr.min.js"></script> <script src="/digpres/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Bashing out a file format signature | NYPL Digital Preservation</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Bashing out a file format signature" /> <meta name="author" content="Nick Krabbenhoeft" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="PRONOM is the digital preservation file format registry of choice, but it’s only as good as the file format signatures that we put into it. There are already great resources about how to do this. Jenny Mitcham from the University of York included links to most resources in her blog post about creating a signature and there is a trove OPF blogs on the subject by Ross Spencer, Andrea Byrne, Becky McGuiness, and others." /> <meta property="og:description" content="PRONOM is the digital preservation file format registry of choice, but it’s only as good as the file format signatures that we put into it. There are already great resources about how to do this. Jenny Mitcham from the University of York included links to most resources in her blog post about creating a signature and there is a trove OPF blogs on the subject by Ross Spencer, Andrea Byrne, Becky McGuiness, and others." /> <link rel="canonical" href="https://nypl.github.io/digpres/posts/bashing-out-a-file-format-signature" /> <meta property="og:url" content="https://nypl.github.io/digpres/posts/bashing-out-a-file-format-signature" /> <meta property="og:site_name" content="NYPL Digital Preservation" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2018-01-30T14:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Bashing out a file format signature" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Nick Krabbenhoeft"},"dateModified":"2018-01-30T14:00:00+00:00","datePublished":"2018-01-30T14:00:00+00:00","description":"PRONOM is the digital preservation file format registry of choice, but it’s only as good as the file format signatures that we put into it. There are already great resources about how to do this. Jenny Mitcham from the University of York included links to most resources in her blog post about creating a signature and there is a trove OPF blogs on the subject by Ross Spencer, Andrea Byrne, Becky McGuiness, and others.","headline":"Bashing out a file format signature","mainEntityOfPage":{"@type":"WebPage","@id":"https://nypl.github.io/digpres/posts/bashing-out-a-file-format-signature"},"url":"https://nypl.github.io/digpres/posts/bashing-out-a-file-format-signature"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/digpres/" class="site-title lh-tight"> NYPL Digital Preservation </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/digpres/about/" class="nav-list-link">About the Program</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Ingest category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/digpres/docs/ingest/overview" class="nav-list-link">Ingest</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Posts category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/digpres/posts/" class="nav-list-link">Posts</a><ul class="nav-list "><li class="nav-list-item "><a href="/digpres/posts/topics" class="nav-list-link">Topics</a></li></ul></li><li class="nav-list-item"><a href="/digpres/contact/" class="nav-list-link">Contact</a></li><li class="nav-list-item"><a href="/digpres/" class="nav-list-link">Home</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search NYPL Digital Preservation" aria-label="Search NYPL Digital Preservation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <p>PRONOM is the digital preservation file format registry of choice, but it’s only as good as the file format signatures that we put into it. There are already great resources about how to do this. Jenny Mitcham from the University of York included links to most resources in her blog post about <a href="http://digital-archiving.blogspot.com/2016/08/my-first-file-format-signature.html">creating a signature</a> and there is a <a href="http://openpreservation.org/knowledge/blogs/topic/format-identification/">trove OPF blogs</a> on the subject by Ross Spencer, Andrea Byrne, Becky McGuiness, and others.</p> <p>This post will be a very fast flyover of building signature for Microsoft’s <a href="https://en.wikipedia.org/wiki/Office_Assistant">ACS format, aka Clippy’s format</a>.</p> <h2 id="gather-some-sample-data"> <a href="#gather-some-sample-data" class="anchor-heading" aria-labelledby="gather-some-sample-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gather some sample data. </h2> <p>The more examples of a format you have, the more confidence you have that you’re finding a good signature. Luckily for ACS, the Microsoft Agent tool had a small <a href="http://msagentring.org/">community</a> that built more of these demonic helpers. I even found one resource with over <a href="http://www.ponx.org/msagent/Acs/">300 examples of agents</a>. So let’s download all of them.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Make a throwaway directory to keep all these files organized.</span>
<span class="o">&gt;</span> <span class="nb">mkdir</span> ~/acs
<span class="o">&gt;</span> <span class="nb">cd</span> ~/acs

<span class="c"># Download all the files</span>
<span class="c"># wget, downloading program</span>
<span class="c"># -r, to open all the links on the page</span>
<span class="c"># -nH, to not create a directory for www.ponx.org</span>
<span class="c"># -np, to not create sub-directories for msagent and Acs</span>
<span class="c"># --cut-dirs, to not download anything outside the Acs directory</span>

<span class="o">&gt;</span> wget <span class="nt">-r</span> <span class="nt">-nH</span> <span class="nt">-np</span> <span class="nt">--cut-dirs</span> 3 http://www.ponx.org/msagent/Acs/</code></pre></figure> <h2 id="look-around-for-magic-numbers"> <a href="#look-around-for-magic-numbers" class="anchor-heading" aria-labelledby="look-around-for-magic-numbers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Look around for magic numbers </h2> <p>A lot of formats use a semi-unique series of bytes at the start of the file to identify themselves. We can see if this is the case by printing out the first 16 bytes of all of the ACS files.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Display first 16 bytes of each file</span>
<span class="c"># head, prints the start of a data stream</span>
<span class="c"># -c 16, limits head to the first 16 bytes</span>
<span class="c"># -q, makes sure the file name is printed</span>
<span class="c"># *.acs, matches all the acs files in the folder</span>
<span class="c"># It doesn't match</span>

<span class="c"># xxd, prints the hexadecimal interpretation</span>
<span class="c"># defaults to 16 bytes per line</span>

<span class="o">&gt;</span> <span class="nb">head</span> <span class="nt">-c</span> 16 <span class="nt">-q</span> <span class="k">*</span>.acs | xxd
0000000: c3ab cdab 33cd 0300 8707 0000 93c9 0300  ....3...........
0000010: c3ab cdab ebbb 2300 ab0a 0000 c3a2 2300  ......#.......#.
0000020: d0cf 11e0 a1b1 1ae1 0000 0000 0000 0000  ................
0000030: c3ab cdab 5e53 0000 4f06 0000 f251 0000  ....^S..O....Q..
0000040: c3ab cdab 017d 0300 a307 0000 697b 0300  .....<span class="o">}</span>......i<span class="o">{</span>..
0000050: c3ab cdab d1dc 0c00 9106 0000 91d9 0c00  ................
0000060: c3ab cdab e628 0a00 eb09 0000 a219 0a00  .....<span class="o">(</span>..........
0000070: c3ab cdab b224 0100 2d06 0000 7823 0100  .....<span class="nv">$.</span>.-...x#..
0000080: c3ab cdab cefc 0100 e906 0000 0afc 0100  ................
0000090: c3ab cdab 4ee5 3700 e70a 0000 f2c9 3700  ....N.7.......7.
00000a0: c3ab cdab 437e 1f00 8307 0000 7161 1f00  ....C~......qa..
00000b0: c3ab cdab 437e 1f00 2c07 0000 7161 1f00  ....C~..,...qa..
00000c0: c3ab cdab 8a92 6000 ff0b 0000 7e6c 6000  ......<span class="sb">`</span>.....~l<span class="sb">`</span>.</code></pre></figure> <h2 id="test-any-patterns"> <a href="#test-any-patterns" class="anchor-heading" aria-labelledby="test-any-patterns"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Test any patterns </h2> <p>The first four bytes (0xC3ABCDAB) look like a good candidate, so let’s see how many files have that as the first 4 bytes.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Count up how many files start with different 4-byte strings</span>
<span class="c"># cut, extract specified fields from data</span>
<span class="c"># -d " ", fields are delimited by spaces</span>
<span class="c"># -f 2,3, extract the 2nd and 3rd field from xxd output</span>

<span class="c"># sort, alphabetical sort of the extracted lines</span>

<span class="c"># uniq -c, count how many of each line there</span>

<span class="o">&gt;</span> <span class="nb">head</span> <span class="nt">-c</span> 16 <span class="nt">-q</span> <span class="k">*</span>.acs | xxd | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">" "</span> <span class="nt">-f</span> 2,3 | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span>
284 c3ab cdab
22 d0cf 11e0</code></pre></figure> <p>You can try cutting more or less fields, but 0xC3ABCDAB looks like the longest common byte string. If you search for 0xD0CF11E0, you’ll find that that is the signature for Microsoft OLE Compound File, a general file structure used as the basis for many formats like .doc Word files and .ppt PowerPoint files. These OLE ACS files probably deserve more research.</p> <h2 id="research-to-backup-your-hypothesis"> <a href="#research-to-backup-your-hypothesis" class="anchor-heading" aria-labelledby="research-to-backup-your-hypothesis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Research to backup your hypothesis </h2> <p>It’s always good to back up your work with data from other people. One potential source is the TrID format registry. In this case there is a <a href="https://github.com/digipres/digipres.github.io/blob/master/_sources/registries/trid/triddefs_xml/ms-acs.trid.xml">signature for ACS files</a>, and it matches our signature.</p> <p>There’s even someone that wrote an <a href="http://fileformats.lebeausoftware.org/">unofficial spec for the format</a>. Remy Lebeau’s work also match our signature.</p> <h2 id="make-and-test-a-pronom-signature-file"> <a href="#make-and-test-a-pronom-signature-file" class="anchor-heading" aria-labelledby="make-and-test-a-pronom-signature-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Make and test a PRONOM signature file </h2> <p>Ross Spencer built this <a href="http://www.nationalarchives.gov.uk/pronom/sigdev/index.htm">excellent tool</a> so that you don’t have to write the XML by hand. Both DROID and Siegfried can be loaded with the custom signature for testing</p> <h2 id="submit-the-signature"> <a href="#submit-the-signature" class="anchor-heading" aria-labelledby="submit-the-signature"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Submit the signature. </h2> <p>Package up any of the information and resources you have found and <a href="https://www.nationalarchives.gov.uk/contact-us/submit-information-for-pronom/">submit them to PRONOM</a>. The folks at the National Archives will look over the signature and contact you with any comments.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
